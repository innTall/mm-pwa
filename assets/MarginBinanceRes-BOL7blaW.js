import{d as L,r as C,s as A,w as P,c as D,o as _,a as h,b as a,e as j,n as p,t as x,F as N,f as M,u as F,g as R,h as u,v as b,i as S,j as c,k as E}from"./index-gJWCLn0d.js";import{_ as O}from"./FooterBinance-BNx3ubcL.js";const T=L("marginBinanceRes",()=>{const g=C([{date:null,symbol:"",buy:null,amnt:null,tp:null,sl:null,activeValue:"set"}]),i=.001,m=.001,y=(l,r,o)=>Number(l*r*i+o*r*m).toFixed(2),V=(l,r,o)=>Number(l*r*i+o*r*m).toFixed(2);return{orderBlocks:g,T_P:(l,r,o)=>{const f=V(l,r,o);return Number((o-l)*r-f).toFixed(2)},S_L:(l,r,o)=>{const f=y(l,r,o);return Number((o-l)*r-f).toFixed(2)},addNewBlock:()=>{g.value.unshift({date:null,symbol:"",buy:null,amnt:null,tp:null,sl:null,activeValue:"set"})},removeBlock:l=>{g.value.splice(l,1)}}},{persist:!0}),z={class:"container min-h-screen mb-10 px-2 py-1 text-sm"},I={class:"flex justify-between border px-2 py-1"},X={class:"text-center font-bold"},q=["onDblclick"],G=["onClick"],H={class:"container flex justify-between"},J={class:"text-yellow-400 font-bold"},K={class:"flex gap-3"},Q={class:"flex gap-3"},W=["for"],Y=["id","onUpdate:modelValue","disabled"],Z=["for"],k=["id","onUpdate:modelValue","disabled","onChange"],ee=["for"],te=["id","onUpdate:modelValue","disabled","onChange"],ae={class:"flex justify-between"},se=["id","onUpdate:modelValue","disabled"],ne=["id","onUpdate:modelValue","disabled"],le=["id","onUpdate:modelValue","disabled"],de=["id","onUpdate:modelValue","disabled"],re=["id","onUpdate:modelValue","disabled"],oe=["id","onUpdate:modelValue","disabled"],ie={class:"fixed w-full h-12 left-0 bottom-0 z-10 bg-gray-900"},ve={__name:"MarginBinanceRes",setup(g){const{orderBlocks:i}=A(T()),{T_P:m,S_L:y,addNewBlock:V,removeBlock:B}=T(),v=n=>{n&&typeof n=="object"&&"value"in n?n.value="":n=""},w=C(!0);P(i,n=>{const t=n[0];t.date&&t.symbol&&t.buy&&t.amnt&&t.tp&&V()},{deep:!0});const U=()=>{w.value&&(V(),w.value=!1)},l=D(()=>!Array.isArray(i.value)||i.value.length===0?0:i.value.reduce((n,t)=>{if(t.activeValue==="profit"){const e=parseFloat(t.buy&&t.amnt&&t.tp?m(t.buy,t.amnt,t.tp):0);return n+e}else if(t.activeValue==="loss"){const e=parseFloat(t.buy&&t.amnt&&t.sl?y(t.buy,t.amnt,t.sl):0);return n+e}return n},0)),r=(n,t)=>{n.disabled=t},o=n=>{r(n,!0)},f=n=>{r(n,!1)};async function $(){if(!i.value||i.value.length<=1){alert("No valid data to save.");return}const n=i.value.slice(1).filter(t=>t.date&&t.symbol&&t.buy&&t.amnt&&t.tp&&t.sl);if(n.length===0){alert("No valid data to save after filtering.");return}try{const{error:t}=await j.from("order_margin").insert(n.map(e=>({date:e.date,symbol:e.symbol,buy:e.buy,amnt:e.amnt,tp:e.tp,sl:e.sl,activeValue:e.activeValue,T_P:m(e.buy,e.amnt,e.tp),S_L:y(e.buy,e.amnt,e.sl)})));t?(console.error("Error saving settings:",t),alert("Failed to save settings.")):alert("Settings saved successfully!")}catch(t){console.error("Unexpected error:",t),alert("An unexpected error occurred.")}}return(n,t)=>(_(),h(N,null,[a("div",z,[a("div",I,[t[6]||(t[6]=a("div",{class:""},"BINANCE Margin Order",-1)),a("button",{onClick:$,class:"bg-blue-400"},"Send"),a("div",X,[a("p",{class:p({"text-green-500 font-bold":l.value>0,"text-red-500 font-bold":l.value<0,"text-gray-500":l.value===0})}," Total: "+x(l.value.toFixed(2)),3)])]),(_(!0),h(N,null,M(F(i),(e,d)=>(_(),h("div",{key:d,class:""},[a("div",{class:"relative flex gap-3",onDblclick:s=>f(e)},[d&&e.activeValue==="set"&&!e.disabled?(_(),h("button",{key:0,onClick:s=>F(B)(d),class:"w-5 bg-red-600 text-white hover:bg-red-500 hover:text-white"}," X ",8,G)):R("",!0),a("div",H,[a("div",J,"Order "+x(d+1),1),a("div",K,[a("div",Q,[a("label",{for:"set"+d,class:p({"text-white font-bold":e.activeValue==="set","text-gray-500":e.activeValue!=="set"})},[u(a("input",{id:"set"+d,type:"radio",value:"set","onUpdate:modelValue":s=>e.activeValue=s,disabled:e.disabled},null,8,Y),[[b,e.activeValue]]),t[7]||(t[7]=S(" Set "))],10,W),a("label",{for:"profit"+d,class:p({"text-green-500 font-bold":e.activeValue==="profit","text-gray-500":e.activeValue!=="profit"})},[u(a("input",{id:"profit"+d,type:"radio",value:"profit","onUpdate:modelValue":s=>e.activeValue=s,disabled:e.disabled,onChange:s=>o(e)},null,40,k),[[b,e.activeValue]]),t[8]||(t[8]=S(" TP "))],10,Z),a("span",{class:p({"text-green-500":e.activeValue==="profit","text-gray-500":e.activeValue!=="profit"})},x(F(m)(e.buy,e.amnt,e.tp)),3),a("label",{for:"loss"+d,class:p({"text-red-500 font-bold":e.activeValue==="loss","text-gray-500":e.activeValue!=="loss"})},[u(a("input",{id:"loss"+d,type:"radio",value:"loss","onUpdate:modelValue":s=>e.activeValue=s,disabled:e.disabled,onChange:s=>o(e)},null,40,te),[[b,e.activeValue]]),t[9]||(t[9]=S(" SL "))],10,ee),a("span",{class:p({"text-red-500":e.activeValue==="loss","text-gray-500":e.activeValue!=="loss"})},x(F(y)(e.buy,e.amnt,e.sl)),3)])])])],40,q),a("div",ae,[u(a("input",{id:"date"+d,type:"date","onUpdate:modelValue":s=>e.date=s,placeholder:"Date",class:"w-[8ch] bg-gray-900 text-center appearance-none",onFocus:t[0]||(t[0]=s=>v(n.date)),disabled:e.disabled},null,40,se),[[c,e.date]]),u(a("input",{id:"symbol"+d,type:"text","onUpdate:modelValue":s=>e.symbol=s,placeholder:"Symbol",class:"w-[6ch] bg-gray-900 text-center uppercase",onFocus:t[1]||(t[1]=s=>v(n.symbol)),disabled:e.disabled},null,40,ne),[[c,e.symbol]]),u(a("input",{id:"buy"+d,type:"number","onUpdate:modelValue":s=>e.buy=s,placeholder:"Buy",class:"w-[8ch] bg-gray-900 text-center text-blue-400 appearance-none",onFocus:t[2]||(t[2]=s=>v(n.buy)),disabled:e.disabled},null,40,le),[[c,e.buy]]),u(a("input",{id:"amnt"+d,type:"number","onUpdate:modelValue":s=>e.amnt=s,placeholder:"Amnt",class:"w-[6ch] bg-gray-900 text-center appearance-none",onFocus:t[3]||(t[3]=s=>v(n.amnt)),disabled:e.disabled},null,40,de),[[c,e.amnt]]),u(a("input",{id:"tp"+d,type:"number","onUpdate:modelValue":s=>e.tp=s,placeholder:"TP",class:p(["w-[8ch] bg-gray-900 text-center appearance-none",{"text-green-400":e.activeValue==="profit","text-gray-500":e.activeValue!=="profit"}]),onFocus:t[4]||(t[4]=s=>v("tp")),disabled:e.disabled},null,42,re),[[c,e.tp]]),u(a("input",{id:"sl"+d,type:"number","onUpdate:modelValue":s=>e.sl=s,placeholder:"SL",class:p(["w-[8ch] bg-gray-900 text-center appearance-none",{"text-red-400":e.activeValue==="loss","text-gray-500":e.activeValue!=="loss"}]),onFocus:t[5]||(t[5]=s=>{v("sl"),U()}),disabled:e.disabled},null,42,oe),[[c,e.sl]])]),t[10]||(t[10]=a("hr",{class:"border-green-600 mt-2"},null,-1))]))),128))]),a("footer",ie,[E(O)])],64))}};export{ve as default};
